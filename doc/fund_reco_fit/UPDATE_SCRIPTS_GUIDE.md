# æ•°æ®æ›´æ–°è„šæœ¬åŠŸèƒ½è¯´æ˜

**ä½ç½®**: `src/scripts/update/`

---

## ğŸ“Š Pythonè„šæœ¬ï¼ˆ3ä¸ªï¼‰

### 1. check_dates.py - æ•°æ®çŠ¶æ€æ£€æŸ¥

**åŠŸèƒ½**: æ£€æŸ¥æ¯åªåŸºé‡‘çš„æœ€æ–°NAVæ•°æ®æ—¥æœŸ

**ç”¨æ³•**:
```bash
.venv/bin/python src/scripts/update/check_dates.py
```

**è¾“å‡º**:
```
æ€»åŸºé‡‘æ•°: 4702

ä¸åŒæœ€æ–°æ—¥æœŸçš„åŸºé‡‘åˆ†å¸ƒï¼š
2026-01-17: 3267 åªåŸºé‡‘
2025-12-26: 1018 åªåŸºé‡‘
2026-01-15: 157 åªåŸºé‡‘
...

éœ€è¦æ›´æ–°çš„åŸºé‡‘: 4702 åª
```

**é€‚ç”¨åœºæ™¯**:
- æ›´æ–°å‰å…ˆäº†è§£æ•°æ®çŠ¶æ€
- æŸ¥çœ‹å“ªäº›åŸºé‡‘éœ€è¦æ›´æ–°

---

### 2. smart_update.py - æ™ºèƒ½å¢é‡æ›´æ–° â­æ¨è

**åŠŸèƒ½**: è‡ªåŠ¨ç”Ÿæˆåˆ†ç»„çš„æ‰¹é‡æ›´æ–°æ–‡ä»¶ï¼ˆæ ¸å¿ƒå·¥å…·ï¼‰

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… è‡ªåŠ¨æ£€æµ‹æ¯åªåŸºé‡‘çš„æœ€æ–°æ•°æ®æ—¥æœŸ
- âœ… æŒ‰æ—¥æœŸåˆ†ç»„ï¼ˆè§£å†³ä¸åŒåŸºé‡‘æ•°æ®æ—¥æœŸä¸åŒçš„é—®é¢˜ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆæ‰¹é‡æ›´æ–°CSVæ–‡ä»¶
- âœ… æ˜¾ç¤ºè¯¦ç»†çš„æ“ä½œæŒ‡å—

**ç”¨æ³•**:
```bash
.venv/bin/python src/scripts/update/smart_update.py
```

**è¾“å‡º**:
```
æ›´æ–°è®¡åˆ’ï¼š
ä» 2026-01-17 æ›´æ–°: 3267 åªåŸºé‡‘
  â†’ å·²ç”Ÿæˆ: batch_update_20260117.csv
ä» 2025-12-27 æ›´æ–°: 1018 åªåŸºé‡‘
  â†’ å·²ç”Ÿæˆ: batch_update_20251227.csv

ä¸‹ä¸€æ­¥æ“ä½œæŒ‡å—ï¼š
æ‰¹æ¬¡ 1:
  cd ../fundseeker
  cp ../fund_reco_fit/batch_update_20260117.csv data/fund_list.csv
  ./fundseeker.sh nav --start-date 2026-01-17
...
```

**å·¥ä½œæµç¨‹**:
1. æŸ¥è¯¢æ•°æ®åº“ä¸­æ¯åªåŸºé‡‘çš„æœ€æ–°æ—¥æœŸ
2. è®¡ç®—æ¯åªåŸºé‡‘éœ€è¦ä»å“ªå¤©å¼€å§‹æ›´æ–°
3. å°†ç›¸åŒèµ·å§‹æ—¥æœŸçš„åŸºé‡‘åˆ†ç»„
4. ä¸ºæ¯ç»„ç”Ÿæˆä¸€ä¸ªCSVæ–‡ä»¶
5. æ˜¾ç¤ºä¸‹ä¸€æ­¥æ“ä½œå‘½ä»¤

**é€‚ç”¨åœºæ™¯**:
- â­ æ¯å‘¨/æ¯æœˆçš„å¸¸è§„æ•°æ®æ›´æ–°
- â­ è¿™æ˜¯æœ€å¸¸ç”¨çš„æ›´æ–°å·¥å…·

---

### 3. incremental_update.py - å¢é‡æ›´æ–°ï¼ˆè‡ªåŠ¨ç‰ˆï¼‰

**åŠŸèƒ½**: ç›´æ¥è°ƒç”¨fundseekeræœåŠ¡è‡ªåŠ¨ä¸‹è½½æ•°æ®

**ç‰¹ç‚¹**:
- å°è¯•è‡ªåŠ¨è°ƒç”¨fundseekerçš„NavService
- éœ€è¦æ­£ç¡®çš„è·¯å¾„é…ç½®
- è¾ƒå°‘ä½¿ç”¨ï¼ˆå› ä¸ºéœ€è¦å¤æ‚çš„è·¯å¾„è®¾ç½®ï¼‰

**ç”¨æ³•**:
```bash
.venv/bin/python src/scripts/update/incremental_update.py
```

**é€‚ç”¨åœºæ™¯**:
- è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ä½¿ç”¨
- ä¸æ¨èæ‰‹åŠ¨ä½¿ç”¨ï¼ˆsmart_update.pyæ›´ç®€å•ï¼‰

---

## ğŸ”§ Shellè„šæœ¬ï¼ˆ4ä¸ªï¼‰

### 4. check_progress.sh - æ£€æŸ¥è¿›åº¦

**åŠŸèƒ½**: æ£€æŸ¥æ•°æ®ä¸‹è½½æˆ–å¤„ç†çš„è¿›åº¦

**ç”¨æ³•**:
```bash
bash src/scripts/update/check_progress.sh
```

**é€‚ç”¨åœºæ™¯**:
- é•¿æ—¶é—´è¿è¡Œä»»åŠ¡æ—¶æŸ¥çœ‹è¿›åº¦
- æ£€æŸ¥åå°ä»»åŠ¡çŠ¶æ€

---

### 5. quick_validate.sh - å¿«é€ŸéªŒè¯

**åŠŸèƒ½**: å¿«é€ŸéªŒè¯æ•°æ®å®Œæ•´æ€§

**ç”¨æ³•**:
```bash
bash src/scripts/update/quick_validate.sh
```

**é€‚ç”¨åœºæ™¯**:
- æ›´æ–°åå¿«é€Ÿæ£€æŸ¥æ•°æ®æ˜¯å¦æ­£å¸¸
- éªŒè¯æ•°æ®åº“è¿æ¥

---

### 6. run_update.sh - è¿è¡Œæ›´æ–°

**åŠŸèƒ½**: è‡ªåŠ¨åŒ–æ‰§è¡Œæ›´æ–°æµç¨‹çš„Shellè„šæœ¬

**ç”¨æ³•**:
```bash
bash src/scripts/update/run_update.sh
```

**é€‚ç”¨åœºæ™¯**:
- ä¸€é”®æ‰§è¡Œå®Œæ•´æ›´æ–°æµç¨‹
- è‡ªåŠ¨åŒ–ä»»åŠ¡

---

### 7. simple_update.sh - ç®€åŒ–æ›´æ–°

**åŠŸèƒ½**: ç®€åŒ–ç‰ˆçš„æ›´æ–°è„šæœ¬

**ç”¨æ³•**:
```bash
bash src/scripts/update/simple_update.sh
```

**é€‚ç”¨åœºæ™¯**:
- å¿«é€Ÿæ›´æ–°å°‘é‡åŸºé‡‘
- æµ‹è¯•æ›´æ–°æµç¨‹

---

## ğŸ¯ æ¨èä½¿ç”¨æµç¨‹

### æ ‡å‡†æ›´æ–°æµç¨‹ï¼ˆæ¨èï¼‰

```bash
cd /path/to/fundseeker/fund_reco_fit

# æ­¥éª¤1: æ£€æŸ¥æ•°æ®çŠ¶æ€
.venv/bin/python src/scripts/update/check_dates.py

# æ­¥éª¤2: ç”Ÿæˆæ›´æ–°è®¡åˆ’
.venv/bin/python src/scripts/update/smart_update.py

# æ­¥éª¤3: æŒ‰ç…§smart_update.pyçš„è¾“å‡ºï¼Œé€ä¸ªæ‰¹æ¬¡ä¸‹è½½æ•°æ®
cd ../fundseeker
cp ../fund_reco_fit/batch_update_YYYYMMDD.csv data/fund_list.csv
./fundseeker.sh nav --start-date YYYY-MM-DD

# æ­¥éª¤4: å¯¼å…¥æ•°æ®
cd ../fund_reco_fit
.venv/bin/python src/scripts/import_data.py

# æ­¥éª¤5: é‡æ–°è®¡ç®—ç‰¹å¾
.venv/bin/python src/feature_builder.py --freq M --table-name features_M_star
```

---

## ğŸ“‹ è„šæœ¬å¯¹æ¯”

| è„šæœ¬ | åŠŸèƒ½ | æ¨èåº¦ | ä½¿ç”¨é¢‘ç‡ |
|------|------|--------|---------|
| check_dates.py | æ£€æŸ¥æ•°æ®çŠ¶æ€ | â­â­â­â­ | æ¯æ¬¡æ›´æ–°å‰ |
| smart_update.py | ç”Ÿæˆæ›´æ–°è®¡åˆ’ | â­â­â­â­â­ | æ¯æ¬¡æ›´æ–°å¿…ç”¨ |
| incremental_update.py | è‡ªåŠ¨æ›´æ–° | â­â­ | è¾ƒå°‘ä½¿ç”¨ |
| check_progress.sh | æ£€æŸ¥è¿›åº¦ | â­â­â­ | é•¿ä»»åŠ¡æ—¶ä½¿ç”¨ |
| quick_validate.sh | å¿«é€ŸéªŒè¯ | â­â­â­ | æ›´æ–°åéªŒè¯ |
| run_update.sh | è‡ªåŠ¨åŒ–æ›´æ–° | â­â­ | è‡ªåŠ¨åŒ–åœºæ™¯ |
| simple_update.sh | ç®€åŒ–æ›´æ–° | â­â­ | æµ‹è¯•ä½¿ç”¨ |

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q: æˆ‘åº”è¯¥ç”¨å“ªä¸ªè„šæœ¬ï¼Ÿ

**A**: å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨ `smart_update.py`ï¼Œå®ƒæ˜¯æœ€æ™ºèƒ½å’Œæœ€å¸¸ç”¨çš„å·¥å…·ã€‚

### Q: smart_update.py å’Œ incremental_update.py æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**:
- `smart_update.py`: ç”Ÿæˆæ‰¹é‡æ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œfundseekerä¸‹è½½ï¼ˆæ¨èï¼‰
- `incremental_update.py`: å°è¯•è‡ªåŠ¨è°ƒç”¨fundseekerä¸‹è½½ï¼ˆè¾ƒå¤æ‚ï¼‰

### Q: ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šShellè„šæœ¬ï¼Ÿ

**A**: è¿™äº›æ˜¯è¾…åŠ©å·¥å…·ï¼Œç”¨äºç‰¹å®šåœºæ™¯ã€‚æ—¥å¸¸ä½¿ç”¨ä¸»è¦ç”¨Pythonè„šæœ¬å³å¯ã€‚

---

**æœ€å¸¸ç”¨çš„ç»„åˆ**: `check_dates.py` + `smart_update.py` + `import_data.py`
